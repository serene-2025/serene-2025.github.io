<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏ã‡∏µ‡∏£‡∏µ‡∏ô</title>
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1571/1571031.png" type="image/png">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
    integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Prompt&display=swap');

    * {
      font-family: 'Kanit', sans-serif;
      /* font-size: 1.2rem; */
    }

    /*Profile Card 5*/
    .profile-card-5 {
      margin-top: 20px;
      border-color: #0e838bFF
    }

    .profile-card-5 .card-img-block {
      width: 91%;
      margin: 0 auto;
      position: relative;
      top: -20px;
    }

    .profile-card-5 .card-img-block img {
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.63);
      width: 100%;
      height: 200px;
      object-fit: contain;
      background: #FFFFFF
    }

    .profile-card-5 h5 {
      color: #4E5E30;
      font-weight: 600;
    }

    .profile-card-5 h3 {
      color: #4E5E30;
      font-weight: 600;
    }

    .profile-card-5 p {
      font-size: 14px;
      font-weight: 300;
    }

    .input-box {
      margin-bottom: 2%;
    }

    /* Set the container's maximum width and center it horizontally */
    .table-container {
      max-width: 100%;
      margin: 0 auto;
      padding: 15px;
      /* Add some padding for spacing */
    }

    /* Make the table responsive and adjust font size for smaller screens */
    .table-responsive {
      overflow-x: auto;
      font-size: 14px;
      /* Adjust as needed */
    }

    /* Apply a flexible width to table columns */
    #dataTable th,
    #dataTable td {
      width: auto;
    }

    /* Prevent line breaks in table cells */
    #dataTable td {
      white-space: nowrap;
    }

    /* Optional: Add some padding to table cells */
    #dataTable th,
    #dataTable td {
      padding: 8px;
    }

    /* Optional: Style the table header */
    #dataTable thead th {
      background-color: #f7f7f7;
      border-bottom: 2px solid #ddd;
    }

    div.dataTables_wrapper div.dataTables_length select {
      width: auto;
      display: inline-block;
      margin-bottom: 10px;
      margin-top: 10px;
    }

    strong {
      display: inline-block;
      margin: 0;
      font-size: 1.5rem;
      padding: 2px 5px;
      border-radius: 3px;
      background-color: #eaeaea;
      color: #b9316f;
      font-weight: 600;
    }
  </style>
</head>

<body>
  <div class="container-fluid mb-4">
    <div class="col-md-8 mx-auto">
      <form class="needs-validation" novalidate id="user_form" onsubmit="getAllElmForm(this)">
        <div class="col-md-12 text-center">
          <h4 class="mb-2 p-2 bg-success text-white"><i class="fa-solid fa-city"></i>üí¥ ‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á Serene </h4>
        </div>

        <div class="col-md-12 mb-2">
          <label><i class="fa-solid fa-circle-user"></i> ü§µ ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•(‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°)‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à <span style="color: red;">*</span></label>
          <input type="text" class="form-control" id="name" name="name" placeholder="‡πÉ‡∏™‡πà ‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" required>
        </div>
        <div class="col-md-12 mb-2">
          <label><i class="fa-solid fa-house"></i> üè° ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <span style="color: red;">*</span></label>
          <input type="text" class="form-control" id="name1" name="name1" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡πÄ‡∏ä‡πà‡∏ô 999/99" required>
        </div>
        <div class="col-md-12 mb-2">
          <h7 label class="mb-3"><i class="fa-solid fa-calendar-days"></i> üìÖ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ <span style="color: red;">*</span></label><br>
          <select class="form-control" id="name2" name="name2" required>
            <option selected disabled value="">
              <----‡πÄ‡∏•‡∏∑‡∏≠‡∏Å.‡πÄ‡∏î‡∏∑‡∏≠‡∏ô---->
            </option>
            <option>‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
            <option>‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
            <option>‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
            <option>‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
            <option>‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
            <option>‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
            <option>‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
            <option>‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
            <option>‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
            <option>‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
            <option>‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
            <option>‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
          </select>
        </div>
        <div class="col-md-12 mb-2">
          <h7 label class="mb-3"><i class="fa-solid fa-calendar-days"></i>üìÜ ‡∏õ‡∏µ ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ <span style="color: red;">*</span></label><br>
          <select class="form-control" id="name3" name="name3" required>
            <option selected disabled value="">
              <----‡πÄ‡∏•‡∏∑‡∏≠‡∏Å.‡∏õ‡∏µ---->
            </option>
            <option>2567</option>
            <option>2568</option>
            <option>2569</option>
            <option>2570</option>
            <option>2571</option>
          </select>
        </div>
        <div class="col-md-12 mb-2">
          <h7 label class="mb-2"><i class="fa-solid fa-mobile-button"></i> üì±‡∏¥ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏à‡πà‡∏≤‡∏¢ ‡πÇ‡∏≠‡∏ô/‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏î <span style="color: red;">*</span></label><br>
          <input type="radio" class="form-check-input me-2" id="name4" name="name4" value="‡πÇ‡∏≠‡∏ô" required>
          <label class="form-check-label me-3">‡πÇ‡∏≠‡∏ô</label>
          <input type="radio" class="form-check-input me-2" id="name4" name="name4" value="‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏î" required>
          <label class="form-check-label me-2">‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏î</label>
        </div>

        <div class="col-md-12 col-12 mb-3">
          <label><i class="fa-solid fa-image"></i> üì∏ ‡∏ñ‡πà‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å / ‡∏†‡∏≤‡∏û‡∏™‡∏•‡∏¥‡∏õ <span style="color: red;">*</span></label>
          <input type="file" class="form-control" id="file_image" name="file_image" onchange="fileValidation()"
            placeholder="‡∏†‡∏≤‡∏û" required>
        </div>
        <div class="input-box" id="imgbox">
          <div class="row mx-auto">
            <img id="picdata" src="" style="display:none">
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-300" id="file_input_help"></p>
          </div>
        </div>
        <div class="mb-3">
          <label><i class="fa-solid fa-file-pen"></i> üìú ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ </label>
          <textarea class="form-control" id="name5" name="name5" rows="3" placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° "></textarea>
        </div>

        <button type="submit" id="btn_1" class="btn btn-danger btn-md w-100 rounded shadow" disabled>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-floppy" viewBox="0 0 18 18">
            <path d="M11 2H9v3h2z" />
            <path d="M1.5 0h11.586a1.5 1.5 0 0 1 1.06.44l1.415 1.414A1.5 1.5 0 0 1 16 2.914V14.5a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 14.5v-13A1.5 1.5 0 0 1 1.5 0M1 1.5v13a.5.5 0 0 0 .5.5H2v-4.5A1.5 1.5 0 0 1 3.5 9h9a1.5 1.5 0 0 1 1.5 1.5V15h.5a.5.5 0 0 0 .5-.5V2.914a.5.5 0 0 0-.146-.353l-1.415-1.415A.5.5 0 0 0 13.086 1H13v4.5A1.5 1.5 0 0 1 11.5 7h-7A1.5 1.5 0 0 1 3 5.5V1H1.5a.5.5 0 0 0-.5.5m3 4a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5V1H4zM3 15h10v-4.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5z" />
          </svg> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
        <button class="btn btn-lg w-100" style="color: #608000;display: none;" type="submit" id="btn_2" disabled>
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
      </form>

      <div class="row">
        <div class="col-md-12 mt-2 mb-3 text-center">
          <h5 class="mb-2 text-danger col-12 "> **‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ö‡∏¥‡∏•‡∏•‡∏∞1‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÇ‡∏≠‡∏ô‡∏£‡∏ß‡∏° ** </h5>
          <div class="row">
            <div class="col-md-12 text-blue">
              <h5 class="mb-2 text-primary">‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á</h5>
              <div class="col-md-12 mt-10">
                ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏î‡πâ‡πÅ‡∏ö‡∏ö ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå ‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á<br>
                (‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô <a class="text-primary" href="https://line.me/ti/p/OZwGJgp1Qq" target="_blank">
                  <i class="fa-brands fa-Line"></i> Line 9one
                </a>)
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>

  <script>
    const urlAPI = "https://script.google.com/macros/s/AKfycbz6Ua9LYQikcgL8OcT3CkEcxfxQNFctPZ1fg5dDP6WTRQEZpvklObLufFFx2a-XBeruYw/exec"; //‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 link webapp ‡∏à‡∏≤‡∏Å appscript

    $(document).ready(function() {
      const liffId = "2000143615-yk0LA09G"; //‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2 ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ LIFF ID
      initializeLiff(liffId);
    });

    function initializeLiff(liffId) {
      liff
        .init({
          liffId: liffId,
          withLoginOnExternalBrowser: true
        })
        .then(async () => {
          if (!liff.isInClient() && !liff.isLoggedIn()) {
            window.alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ LINE ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì");
            const destinationUrl = window.location.href;
            liff.login({
              redirectUri: destinationUrl
            });
          }
          const urlParms = new URLSearchParams(window.location.search)
          id = urlParms.get('id')

          await reloadData(id)
          await Dropdown()
          sessionStorage.setItem('idProduct', JSON.stringify(id));

          liff.getProfile().then(function(profile) {
            uid = profile.userId;
            uname = profile.displayName;
            picture = profile.pictureUrl;
            xos = liff.getOS();
            emailL = liff.getDecodedIDToken().email;
          })
        })
        .catch((err) => {
          console.log('LIFF Initialization failed ', err);
        });
    }

    function sendFlexMessage(uid, uname, picture, name, name1, name2, name3) {
      const flexMessage = {
        type: "flex",
        altText: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
        contents: {
          "type": "bubble",
          "hero": {
            "type": "image",
            "url": "" + picture,
            "size": "full",
            "aspectRatio": "20:13",
            "aspectMode": "cover",
            "action": {
              "type": "uri",
              "uri": "https://liff.line.me/2000143615-7xXDlXpx"
            }
          },
          "body": {
            "type": "box",
            "layout": "vertical",
            "contents": [{
                "type": "text",
                "text": "üí¥ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                "weight": "bold",
                "size": "xl"
              },
              {
                "type": "box",
                "layout": "vertical",
                "margin": "lg",
                "spacing": "sm",
                "contents": [{
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "flex": 2
                      },
                      {
                        "type": "text",
                        "text": "" + new Date(),
                        "wrap": true,
                        "color": "#666666",
                        "size": "xs",
                        "flex": 5
                      }
                    ]
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏•‡∏ô‡πå : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "flex": 2
                      },
                      {
                        "type": "text",
                        "text": "" + uname,
                        "wrap": true,
                        "color": "#666666",
                        "size": "xs",
                        "flex": 5
                      }
                    ]
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "Uid : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "flex": 2
                      },
                      {
                        "type": "text",
                        "text": "" + uid,
                        "wrap": true,
                        "color": "#666666",
                        "size": "sm",
                        "flex": 5
                      }
                    ]
                  },
                  {
                    "type": "separator"
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "ü§µ‚Äç‚ôÇÔ∏è ‡∏ä‡∏∑‡πà‡∏≠ : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "wrap": true,
                        "flex": 3,
                        "margin": "md",
                        "gravity": "center"
                      },
                      {
                        "type": "text",
                        "text": "" + name,
                        "wrap": true,
                        "color": "#666666",
                        "size": "sm",
                        "flex": 5,
                        "align": "end",
                        "gravity": "center"
                      }
                    ]
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "üè° ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "wrap": true,
                        "flex": 3,
                        "margin": "md",
                        "gravity": "center"
                      },
                      {
                        "type": "text",
                        "text": "" + name1,
                        "wrap": true,
                        "color": "#666666",
                        "size": "sm",
                        "flex": 5,
                        "align": "end",
                        "gravity": "center"
                      }
                    ]
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "üìÜ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "wrap": true,
                        "flex": 3,
                        "margin": "md",
                        "gravity": "center"
                      },
                      {
                        "type": "text",
                        "text": "" + name2,
                        "wrap": true,
                        "color": "#666666",
                        "size": "sm",
                        "flex": 5,
                        "align": "end",
                        "gravity": "center"
                      }
                    ]
                  },
                  {
                    "type": "box",
                    "layout": "baseline",
                    "spacing": "sm",
                    "contents": [{
                        "type": "text",
                        "text": "üóì ‡∏õ‡∏µ : ",
                        "color": "#aaaaaa",
                        "size": "sm",
                        "wrap": true,
                        "flex": 3,
                        "margin": "md",
                        "gravity": "center"
                      },
                      {
                        "type": "text",
                        "text": "" + name3,
                        "wrap": true,
                        "color": "#666666",
                        "size": "sm",
                        "flex": 5,
                        "align": "end",
                        "gravity": "center"
                      }
                    ]
                  },
                  {
                    "type": "separator"
                  },
                  {
                    "type": "text",
                    "text": " ",
                    "wrap": true,
                    "size": "xs",
                    "color": "#8C8C8C",
                    "contents": [{
                      "type": "span",
                      "text": "‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á"
                    }]
                  },
                  {
                    "type": "text",
                    "text": " ",
                    "wrap": true,
                    "size": "xs",
                    "color": "#8C8C8C",
                    "contents": [{
                      "type": "span",
                      "text": "‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ : ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ"
                    }]
                  },
                ]
              }
            ]
          },
          "footer": {
            "type": "box",
            "layout": "vertical",
            "spacing": "sm",
            "contents": [{
                "type": "button",
                "style": "primary",
                "height": "sm",
                "action": {
                  "type": "uri",
                  "label": "‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                  "uri": "https://liff.line.me/2000143615-7xXDlXpx"
                }
              },
              {
                "type": "box",
                "layout": "vertical",
                "contents": [],
                "margin": "sm"
              }
            ],
            "flex": 0
          }
        }
      };

      liff
        .sendMessages([flexMessage])
        .then(() => console.log("FlexMessage sent to", uid))
        .catch((err) => console.error("Error sending FlexMessage:", err));
    }

    /**‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ submit ‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á */
    function preventFormSubmit() {
      var forms = document.querySelectorAll("form");
      for (var i = 0; i < forms.length; i++) {
        forms[i].addEventListener("submit", function(event) {
          event.preventDefault();
        });
      }
    }
    window.addEventListener("load", preventFormSubmit);

    /** ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå */
    async function reloadData(id) {
      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
        html: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà <strong></strong> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ.',
        timer: 5000,
        timerProgressBar: true,
        didOpen: () => {
          Swal.showLoading()
          const b = Swal.getHtmlContainer().querySelector('strong')
          timerInterval = setInterval(() => {
            b.textContent = (Swal.getTimerLeft() / 1000).toFixed(0)
          }, 100)
        },
        willClose: () => {
          clearInterval(timerInterval)
        }
      }).then((result) => {
        if (result.dismiss === Swal.DismissReason.timer) {
          console.log('I was closed by the timer')
        }
      })

      const obj = {};
      obj.uid = id
      const formData = JSON.stringify(obj);

      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: `${urlAPI}?action=loadDataRegister`,
        headers: {},
        data: formData,
        mode: 'no-cors',
      };

      axios
        .request(config)
        .then((response) => {
          const msgResponse = response.data;
          const datareturn = msgResponse.data.split(",")

          if (msgResponse.msg == "SUCCESS") {
            $('#databox').removeClass('d-none');
            $("#picdataRe").attr("src", datareturn[9]);
            $("#idR").html(idR)
            $("#nameR").html(nameR)
            $("#detailR").html(detailR)
          } else {
            Swal.fire({
              title: '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏°‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
              text: `${msgResponse.msg}`,
              icon: 'error',
              showCancelButton: false,
              confirmButtonColor: '#d33',
              confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
            }).then((result) => {
              if (result.isConfirmed) {
                // liff.closeWindow()
              }
            })
          }
        })
        .catch((error) => {
          console.log(error);
        });
    }

    //‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô dropdown ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°  ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠/‡∏≠‡∏µ‡πÄ‡∏°‡∏•
    async function Dropdown() {
      try {
        $.ajax({
          url: `${urlAPI}?type=namelist`,
          type: 'GET',
          dataType: 'json', // added data type
          success: function(res) {
            dropdownListlevel(res)
          }
        });
      } catch (error) {
        console.error(error);
      }
    }

    /** ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï ‡∏≠.‡πÄ‡∏Å‡πã */
    function getAllElmForm(data) {
      const name = document.getElementById("name").value;
      const name1 = document.getElementById("name1").value;
      const name2 = document.getElementById("name2").value;
      const name3 = document.getElementById("name3").value;

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
        html: '‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà <strong></strong> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ.',
        timer: 10000,
        timerProgressBar: true,
        didOpen: () => {
          Swal.showLoading()
          const b = Swal.getHtmlContainer().querySelector('strong')
          timerInterval = setInterval(() => {
            b.textContent = (Swal.getTimerLeft() / 1000).toFixed(0)
          }, 100)
        },
        willClose: () => {
          clearInterval(timerInterval)
        }
      }).then((result) => {
        if (result.dismiss === Swal.DismissReason.timer) {
          console.log('I was closed by the timer')
        }
      })

      const form = document.getElementById("user_form");

      $("#btn_1").hide();
      $("#btn_2").show();
      var obj = {};
      var data = new FormData();

      var all = document.querySelectorAll(
        "#user_form input, #user_form select, #user_form textarea"
      );

      for (let field of all) {
        if (field.type != "button" && field.type != "submit") {
          if (field.type == "radio" || field.type == "checkbox") {
            if (field.checked) {
              data.append(field.name, field.value);
            }
          } else {
            data.append(field.name, field.value);
          }
        }
      }
      for (let [key, val] of data.entries()) {
        obj[key] = val;
      }

      obj.imageFile = document.getElementById("picdata").src
      obj.uid = uid
      const formData = JSON.stringify(obj);
      console.log(formData)

      let config = {
        method: "post",
        maxBodyLength: Infinity,
        url: `${urlAPI}?action=saveDataNew`,
        headers: {},
        data: formData,
        mode: 'no-cors',
      };

      axios
        .request(config)
        .then((response) => {
          const msgResponse = response.data;

          if (msgResponse.msg == "SUCCESS") {
            $("#btn_2").hide();
            $("#btn_1").show();
            $('#picdata').hide()
            $("#picdata").attr("src", "")
            $("#file_input_help").html("")
            document.getElementById("user_form").reset();
            document
              .getElementsByClassName("needs-validation")[0]
              .classList.remove("was-validated");

            sendFlexMessage(uid, uname, picture, name, name1, name2, name3);

            Swal.fire({
              title: '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á',
              text: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
              icon: 'success',
              showCancelButton: false,
              confirmButtonColor: '#3085d6',
              confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
            }).then(async (result) => {
              if (result.isConfirmed) {
                reloadData(msgResponse.id)
                liff.closeWindow()
              }
            })
          } else {
            $("#btn_2").hide();
            $("#btn_1").show();
            $('#picdata').hide()
            $("#picdata").attr("src", "")
            $("#file_input_help").html("")
            document
              .getElementsByClassName("needs-validation")[0]
              .classList.remove("was-validated");

            Swal.fire({
              title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
              text: `${msgResponse.msg}`,
              icon: 'error',
              showCancelButton: false,
              confirmButtonColor: '#d33',
              confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á'
            }).then((result) => {
              if (result.isConfirmed) {
                //liff.closeWindow()
              }
            })
          }
        })
    }

    /** ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö */
    // 1. ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö upload ‡∏£‡∏π‡∏õ‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
    let imgupload = document.getElementById('file_image');
    imgupload.addEventListener('change', function(e) {

      if (e.target.files[0]) {
        document.getElementById('picdata').style.display = 'block'

        let imageVal = e.target.files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = document.createElement("img");
          img.onload = function(event) {
            // This line is dynamically creating a canvas element
            const canvas = document.createElement("canvas");

            let url = canvas.toDataURL(imageVal.type);
            // console.log(url)
            // document.getElementById("picdata").src = url;
          }
          img.src = e.target.result;
        }
        reader.readAsDataURL(imageVal);
      } else {
        document.getElementById("picdata").src = "";
      }
    });
    //‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏≠.‡∏£‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á
    function fileValidation() {
      var fileInput = document.querySelector("#file_image");
      //    console.log(fileInput)
      var filePath = fileInput.value;
      //    console.log(filePath)
      var allowedExtensions = /(\.jpg|\.jpeg|\.png|\.gif)$/i;

      var iConvert = (fileInput.files[0].size / (1024 * 1024)).toFixed(2);
      let txt = "‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå: " + iConvert + " MB <br/>";
      $("#file_input_help").html("")
      if (fileInput.files[0].size > 3 * 1048576) {
        document.getElementById('picdata').style.display = 'none'
        Swal.fire({
          position: 'top',
          icon: 'info',
          title: '‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô !',
          text: '‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 mb',
          confirmButtonColor: '#000',
          confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á!'
        })

        fileInput.value = ''

      } else {


        if (!allowedExtensions.exec(filePath)) {

          Swal.fire({
            position: 'top',
            icon: 'error',
            title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô!!',
            showConfirmButton: false,
            timer: 1500
          })
          fileInput.value = '';

          return false;
        } else {
          $('#picdata').removeClass('d-none')
          $("#file_input_help").html(txt)
          //Image preview
          if (fileInput.files && fileInput.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
              document.getElementById('picdata').src = e.target.result
            };
            reader.readAsDataURL(fileInput.files[0]);
            console.log(fileInput.files[0])
          }
        }
      }
    }


    (function() {
      "use strict";

      var forms = document.querySelectorAll(".needs-validation");

      Array.prototype.slice.call(forms).forEach(function(form) {
        form.addEventListener(
          "submit",
          function(event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
              showError("‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
            }
            form.classList.add("was-validated");
          },
          false
        );
      });
    })();

    /** ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠ Error (‡πÉ‡∏ä‡πâ SweetAlert2) */
    function showError(e) {
      Swal.fire({
        title: e,
        icon: "warning",
        confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
      });
    }

    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô validateForm ‡πÅ‡∏•‡∏∞ checkFormValidity
    function validateForm(event) {
      event.preventDefault();
      const name = document.getElementById('name').value;
      const name1 = document.getElementById('name1').value;
      const name2 = document.getElementById('name2').value;
      const name3 = document.getElementById('name3').value;
      const file_image = document.getElementById('file_image').value;
      const name4 = document.querySelector('input[name="name4"]:checked');

      if (name && name1 && name2 && name3 && file_image && name4) {
        document.getElementById('btn_1').disabled = false;
        document.getElementById('user_form').submit();
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
        });
      }
    }

    document.getElementById('name').addEventListener('input', checkFormValidity);
    document.getElementById('name1').addEventListener('input', checkFormValidity);
    document.getElementById('name2').addEventListener('change', checkFormValidity);
    document.getElementById('name3').addEventListener('change', checkFormValidity);
    document.getElementById('file_image').addEventListener('change', checkFormValidity);
    document.querySelectorAll('input[name="name4"]').forEach(radio => {
      radio.addEventListener('change', checkFormValidity);
    });


    function checkFormValidity() {
      const name = document.getElementById('name').value;
      const name1 = document.getElementById('name1').value;
      const name2 = document.getElementById('name2').value;
      const name3 = document.getElementById('name3').value;
      const file_image = document.getElementById('file_image').value;
      const name4 = document.querySelector('input[name="name4"]:checked');

      if (name && name1 && name2 && name3 && file_image && name4) {
        document.getElementById('btn_1').disabled = false;
      } else {
        document.getElementById('btn_1').disabled = true;
      }
    }
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å local storage
      const savedName = localStorage.getItem('name');
      const savedHouseNumber = localStorage.getItem('name1');

      if (savedName) {
        document.getElementById('name').value = savedName;
      }

      if (savedHouseNumber) {
        document.getElementById('name1').value = savedHouseNumber;
      }

      validateForm();
    });

    function saveFormData() {
      const name = document.getElementById('name').value;
      const houseNumber = document.getElementById('name1').value;

      localStorage.setItem('name', name);
      localStorage.setItem('name1', houseNumber);
    }

    function validateForm() {
      var name = document.getElementById('name').value;
      var name1 = document.getElementById('name1').value;
      var name2 = document.getElementById('name2').value;
      var name3 = document.getElementById('name3').value;
      var name4 = document.querySelector('input[name="name4"]:checked');

      if (name && name1 && name2 && name3 && name4) {
        document.getElementById('btn_1').disabled = false;
        document.getElementById('btn_1').classList.remove('btn-danger');
        document.getElementById('btn_1').classList.add('btn-success');
      } else {
        document.getElementById('btn_1').disabled = true;
        document.getElementById('btn_1').classList.remove('btn-success');
        document.getElementById('btn_1').classList.add('btn-danger');
      }
    }

    document.getElementById('name').addEventListener('input', validateForm);
    document.getElementById('name1').addEventListener('input', validateForm);
    document.getElementById('name2').addEventListener('change', validateForm);
    document.getElementById('name3').addEventListener('change', validateForm);
    document.querySelectorAll('input[name="name4"]').forEach(input => {
      input.addEventListener('change', validateForm);
    });

    document.getElementById('user_form').addEventListener('submit', function(event) {
      saveFormData();
      // ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
    });
  </script>
</body>

</html>
