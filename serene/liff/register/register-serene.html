<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Sarabun', sans-serif; }
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      min-height: 100vh; position: relative; overflow-x: hidden;
    }
    .form-container {
      backdrop-filter: blur(20px);
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
    }
    .input-focus { transition: all 0.3s; border: 2px solid #e5e7eb; }
    .input-focus:focus { border-color: #667eea; box-shadow: 0 0 10px rgba(102,126,234,0.3); }
    .submit-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-size: 200% 200%; animation: gradientShift 3s ease infinite;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
  </style>
</head>
<body class="gradient-bg flex items-center justify-center p-4">

  <div class="form-container max-w-2xl w-full rounded-2xl shadow-2xl p-8 relative z-10">
    <!-- Header -->
    <div class="text-center mb-8">
      <div class="w-24 h-24 mx-auto mb-6 rounded-full overflow-hidden border-4 border-purple-400" id="profilePicContainer">
        <img id="picURL" src="https://via.placeholder.com/100" class="w-full h-full object-cover" />
      </div>
      <h1 class="text-3xl font-bold text-purple-700">‚ú® ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‚ú®</h1>
    </div>

    <!-- Registration Form -->
    <form id="loginForm" class="space-y-6" name="google-sheet" autocomplete="off">
      <!-- Hidden fields -->
      <input type="hidden" id="uid" name="Uid">
      <input type="hidden" id="upic" name="Upic">
      <input type="hidden" id="uname" name="UName">
      <input type="hidden" id="RichMenuID" name="RichMenuID" value="richmenu-0bd347b4edc64174ace50549713b0a3b">

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Full Name -->
        <div class="md:col-span-2">
          <label class="block text-gray-700 mb-1">üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
          <input type="text" id="name0" name="name0" required
            class="input-focus w-full px-4 py-3 rounded-lg" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
        </div>

        <!-- Phone -->
        <div>
          <label class="block text-gray-700 mb-1">üì± ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ *</label>
          <input type="tel" id="phone" name="phone" required
            class="input-focus w-full px-4 py-3 rounded-lg" placeholder="0xx-xxx-xxxx">
        </div>

        <!-- House No -->
        <div>
          <label class="block text-gray-700 mb-1">üè† ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà *</label>
          <input type="text" id="name1" name="name1" required
            class="input-focus w-full px-4 py-3 rounded-lg" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô">
        </div>

        <!-- Soi -->
        <div>
          <label class="block text-gray-700 mb-1">üõ£Ô∏è ‡∏ã‡∏≠‡∏¢ *</label>
          <select id="room" name="room" required
            class="input-focus w-full px-4 py-3 rounded-lg">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏≠‡∏¢</option>
            <option value="‡∏ã‡∏≠‡∏¢ 1">‡∏ã‡∏≠‡∏¢ 1</option>
            <option value="‡∏ã‡∏≠‡∏¢ 2">‡∏ã‡∏≠‡∏¢ 2</option>
            <option value="‡∏ã‡∏≠‡∏¢ 3">‡∏ã‡∏≠‡∏¢ 3</option>
            <option value="‡∏ã‡∏≠‡∏¢ 4">‡∏ã‡∏≠‡∏¢ 4</option>
            <option value="‡∏ã‡∏≠‡∏¢ 5">‡∏ã‡∏≠‡∏¢ 5</option>
            <option value="‡∏ã‡∏≠‡∏¢ 6">‡∏ã‡∏≠‡∏¢ 6</option>
            <option value="‡∏ã‡∏≠‡∏¢ 7">‡∏ã‡∏≠‡∏¢ 7</option>
            <option value="‡∏ã‡∏≠‡∏¢ 8">‡∏ã‡∏≠‡∏¢ 8</option>
            <option value="‡∏ã‡∏≠‡∏¢ 9">‡∏ã‡∏≠‡∏¢ 9</option>
            <option value="‡∏ã‡∏≠‡∏¢ 10">‡∏ã‡∏≠‡∏¢ 10</option>
            <option value="‡∏ã‡∏≠‡∏¢ 11">‡∏ã‡∏≠‡∏¢ 11</option>
            <option value="‡∏ã‡∏≠‡∏¢ 12">‡∏ã‡∏≠‡∏¢ 12</option>
          </select>
        </div>

        <!-- Living Status -->
        <div>
          <label class="block text-gray-700 mb-1">üè° ‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢ *</label>
          <select id="name2" name="name2" required
            class="input-focus w-full px-4 py-3 rounded-lg">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
            <option value="‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏ô">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏ô</option>
            <option value="‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏ß‡∏°">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πà‡∏ß‡∏°</option>
            <option value="‡∏ú‡∏π‡πâ‡∏≠‡∏≤‡∏®‡∏±‡∏¢">‡∏ú‡∏π‡πâ‡∏≠‡∏≤‡∏®‡∏±‡∏¢</option>
            <option value="‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤">‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</option>
            <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏≠‡∏¢‡∏π‡πà">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏≠‡∏¢‡∏π‡πà</option>
            <option value="‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏á">‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏á</option>
            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
          </select>
        </div>

        <!-- Member Count -->
        <div>
          <label class="block text-gray-700 mb-1">üë• ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å *</label>
          <select id="name3" name="name3" required
            class="input-focus w-full px-4 py-3 rounded-lg">
            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</option>
            <option value="1">1 ‡∏Ñ‡∏ô</option>
            <option value="2">2 ‡∏Ñ‡∏ô</option>
            <option value="3">3 ‡∏Ñ‡∏ô</option>
            <option value="4">4 ‡∏Ñ‡∏ô</option>
            <option value="5">5 ‡∏Ñ‡∏ô</option>
            <option value="6">6 ‡∏Ñ‡∏ô</option>
            <option value="7">7 ‡∏Ñ‡∏ô</option>
            <option value="8">8 ‡∏Ñ‡∏ô</option>
            <option value="9">9 ‡∏Ñ‡∏ô</option>
            <option value="10">10 ‡∏Ñ‡∏ô</option>
          </select>
        </div>

        <!-- Email -->
        <div>
          <label class="block text-gray-700 mb-1">üìß E-mail</label>
          <input type="email" id="name4" name="name4"
            class="input-focus w-full px-4 py-3 rounded-lg" placeholder="example@email.com">
        </div>

        <!-- Line ID -->
        <div>
          <label class="block text-gray-700 mb-1">üí¨ Line ID</label>
          <input type="text" id="name5" name="name5"
            class="input-focus w-full px-4 py-3 rounded-lg" placeholder="Line ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
        </div>
      </div>

      <!-- Checkbox -->
      <div class="mt-6 flex items-start space-x-3">
        <input type="checkbox" id="agreeTerms" class="w-5 h-5 text-purple-600">
        <label for="agreeTerms" class="text-sm text-gray-700 leading-relaxed">
          üìã ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
        </label>
      </div>

      <!-- Submit Button -->
      <div class="mt-6">
        <button type="submit" id="submit" disabled
          class="submit-btn w-full text-white py-4 px-6 rounded-xl font-bold text-lg disabled:opacity-50">
          üöÄ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        </button>
      </div>
    </form>
  </div>

  <!-- JavaScript -->
  <script>
    // Initialize LIFF
    function initializeLiff(myLiffId) {
      liff.init({ liffId: myLiffId })
        .then(() => { getProfile(); setupForm(); })
        .catch((err) => { console.error("LIFF Initialization failed:", err); });
    }

    // Get user profile
    function getProfile() {
      liff.getProfile()
        .then((profile) => {
          const { userId, displayName, pictureUrl } = profile;
          document.getElementById("picURL").src = pictureUrl;
          document.getElementById("uid").value = userId;
          document.getElementById("uname").value = displayName;
          document.getElementById("upic").value = pictureUrl;
        })
        .catch((err) => { console.error("Failed to get profile:", err); });
    }

    // Setup form
    function setupForm() {
      const form = document.forms['google-sheet'];
      const submitButton = document.getElementById("submit");
      const agreeTerms = document.getElementById("agreeTerms");

      // toggle button
      agreeTerms.addEventListener("change", () => {
        submitButton.disabled = !agreeTerms.checked;
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        submitForm();
        liff.getProfile().then((profile) => {
          sendRegistrationMessage(profile);
        });
      });
    }

    // Submit form data to Google Sheets
    function submitForm() {
      const scriptURL = 'https://script.google.com/macros/s/AKfycbzDBa9nJZ-qFyNn-qoM8f59pjp5JDbxizK8DIWdj0zBkOG7bTUu5JBOwGj1EpycGFvt/exec';
      const form = document.forms['google-sheet'];
      fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .catch((error) => { console.error('Error!', error.message); });
    }

    // Send registration success message
    function sendRegistrationMessage(profile) {
      const { userId, displayName, pictureUrl } = profile;
      const phone = document.getElementById("phone");
      const name0 = document.getElementById("name0");
      const name1 = document.getElementById("name1");
      const room = document.getElementById("room");
      const name2 = document.getElementById("name2");
      const name3 = document.getElementById("name3");

      liff.sendMessages([{
        type: "text",
        text: `‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢\n‡∏ä‡∏∑‡πà‡∏≠: ${name0.value}\n‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: ${name1.value}\n‡∏ã‡∏≠‡∏¢: ${room.value}\n‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢: ${name2.value}\n‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å: ${name3.value}\n‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${phone.value}`
      }]);

      Swal.fire({
        icon: 'success',
        title: '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ !!',
        text: '‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞',
        timer: 4000,
        showConfirmButton: false
      }).then(() => { liff.closeWindow(); });
    }

    // Run LIFF
    window.onload = () => { initializeLiff("2000143615-Y8AQVAaq"); };
  </script>
</body>
</html>
